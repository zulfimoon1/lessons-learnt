import{r,u as w,a as N,j as e,b as v,d as C,h as S,e as D,f as _,g as F,L as m,H as O,i as b,q as k,l as T,k as A,s as E}from"./index-KPEZ0muq.js";import{C as H,E as L}from"./checkbox-Dj8IvW5t.js";const W=({student:a})=>{const[n,d]=r.useState(""),[o,x]=r.useState(""),[i,u]=r.useState(!1),[h,y]=r.useState(!1),{toast:c}=w(),{t:s}=N(),f=async t=>{if(t.preventDefault(),!n.trim()&&!o.trim()){c({title:s("weekly.fillAtLeastOne"),description:s("weekly.shareThoughts"),variant:"destructive"});return}y(!0);try{const{error:l}=await E.from("weekly_summaries").insert({student_id:i?null:a==null?void 0:a.id,student_name:i?s("weekly.anonymous"):(a==null?void 0:a.full_name)||"",school:(a==null?void 0:a.school)||"",grade:(a==null?void 0:a.grade)||"",emotional_concerns:n.trim()||null,academic_concerns:o.trim()||null,week_start_date:g(new Date),is_anonymous:i});if(l)throw l;c({title:s("weekly.submitted"),description:s("weekly.submittedDesc")}),d(""),x(""),u(!1)}catch{c({title:s("weekly.submitFailed"),description:s("weekly.submitFailedDesc"),variant:"destructive"})}finally{y(!1)}},g=t=>{const l=new Date(t),p=l.getDay(),j=l.getDate()-p+(p===0?-6:1);return l.setDate(j),l.setHours(0,0,0,0),l.toISOString().split("T")[0]};return e.jsxs(v,{className:"bg-white/80 backdrop-blur-sm border-blue-100",children:[e.jsxs(C,{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-600 rounded-full mx-auto flex items-center justify-center mb-4",children:e.jsx(S,{className:"w-8 h-8 text-white"})}),e.jsx(D,{className:"text-2xl text-gray-900",children:s("weekly.title")}),e.jsx(_,{className:"text-lg",children:s("weekly.subtitle")})]}),e.jsx(F,{children:e.jsxs("form",{onSubmit:f,className:"space-y-6",children:[e.jsx("div",{className:"text-center mb-6",children:e.jsx("p",{className:"text-gray-700 font-medium",children:s("weekly.howFeeling")})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs(m,{htmlFor:"emotional",className:"flex items-center gap-2 text-base font-medium",children:[e.jsx(O,{className:"w-5 h-5 text-pink-500"}),s("weekly.emotional")]}),e.jsx(b,{variant:"outline",className:"mb-2 bg-pink-50 text-pink-700 border-pink-200",children:s("weekly.optional")}),e.jsx(k,{id:"emotional",placeholder:s("weekly.emotionalPlaceholder"),value:n,onChange:t=>d(t.target.value),className:"min-h-[100px] resize-none"})]}),e.jsxs("div",{children:[e.jsxs(m,{htmlFor:"academic",className:"flex items-center gap-2 text-base font-medium",children:[e.jsx(T,{className:"w-5 h-5 text-blue-500"}),s("weekly.academic")]}),e.jsx(b,{variant:"outline",className:"mb-2 bg-blue-50 text-blue-700 border-blue-200",children:s("weekly.optional")}),e.jsx(k,{id:"academic",placeholder:s("weekly.academicPlaceholder"),value:o,onChange:t=>x(t.target.value),className:"min-h-[100px] resize-none"})]}),e.jsxs("div",{className:"flex items-center space-x-2 p-4 bg-gray-50 rounded-lg",children:[e.jsx(H,{id:"anonymous",checked:i,onCheckedChange:t=>u(t)}),e.jsxs(m,{htmlFor:"anonymous",className:"flex items-center gap-2 text-sm",children:[e.jsx(L,{className:"w-4 h-4 text-gray-500"}),s("weekly.submitAnonymously")]})]})]}),e.jsx("div",{className:"flex justify-center pt-4",children:e.jsx(A,{type:"submit",disabled:h,className:"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700",children:s(h?"weekly.submitting":"weekly.submit")})})]})})]})},z=({student:a})=>e.jsx("div",{className:"space-y-6",children:e.jsx(W,{student:a})});export{z as default};
