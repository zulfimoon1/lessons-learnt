import{r as o,u as C,a as b,s as D,j as e,B as u,b as p,d as N,e as f,h as j,f as v,g as w,U as L,i as g,T,k as y}from"./index-KPEZ0muq.js";const W=({school:c})=>{const[i,d]=o.useState([]),[n,r]=o.useState(!0),{toast:S}=C(),{t:a}=b();o.useEffect(()=>{m()},[c]);const m=async()=>{try{const{data:s,error:t}=await D.from("weekly_summaries").select("*").eq("school",c).order("submitted_at",{ascending:!1}).limit(50);if(t)throw t;d(s||[])}catch(s){console.error("Error loading weekly summaries:",s),S({title:a("common.error"),description:a("teacher.failedToLoadSummaries"),variant:"destructive"})}finally{r(!1)}},k=s=>new Date(s).toLocaleDateString(),_=s=>{const t=new Date(s),h=new Date(t);return h.setDate(t.getDate()+6),`${t.toLocaleDateString()} - ${h.toLocaleDateString()}`},l=s=>s.emotional_concerns||s.academic_concerns,x=[{label:a("teacher.dashboard"),href:"/teacher"},{label:a("dashboard.weeklySummaries"),current:!0}];return n?e.jsxs("div",{className:"p-6",children:[e.jsx(u,{items:x}),e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"})})]}):e.jsxs("div",{className:"p-6",children:[e.jsx(u,{items:x}),e.jsxs(p,{className:"border-green-100",children:[e.jsxs(N,{children:[e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(j,{className:"w-5 h-5"}),a("dashboard.weeklySummaries")]}),e.jsxs(v,{children:[a("teacher.reviewStudentSummaries")," ",c]})]}),e.jsxs(w,{children:[e.jsxs("div",{className:"space-y-4",children:[i.map(s=>e.jsxs("div",{className:`p-4 border rounded-lg ${l(s)?"border-orange-200 bg-orange-50":"border-gray-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"font-medium",children:s.student_name}),e.jsx(g,{variant:"outline",children:s.grade}),l(s)&&e.jsxs(g,{variant:"destructive",className:"flex items-center gap-1",children:[e.jsx(T,{className:"w-3 h-3"}),a("teacher.needsAttention")]})]}),e.jsxs("div",{className:"text-right text-sm text-gray-500",children:[e.jsx("div",{children:_(s.week_start_date)}),e.jsxs("div",{children:[a("teacher.submitted"),": ",k(s.submitted_at)]})]})]}),s.emotional_concerns&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("h4",{className:"font-medium text-sm text-pink-700 mb-1",children:[a("weekly.emotional"),":"]}),e.jsx("p",{className:"text-gray-700 text-sm bg-white p-2 rounded border",children:s.emotional_concerns})]}),s.academic_concerns&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-sm text-blue-700 mb-1",children:[a("weekly.academic"),":"]}),e.jsx("p",{className:"text-gray-700 text-sm bg-white p-2 rounded border",children:s.academic_concerns})]}),!l(s)&&e.jsx("p",{className:"text-gray-500 text-sm italic",children:a("teacher.noSpecificConcerns")})]},s.id)),i.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(j,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:a("teacher.noWeeklySummaries")}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:a("teacher.summariesWillAppearHere")})]})]}),i.length>0&&e.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:e.jsx(y,{onClick:m,variant:"outline",className:"w-full",children:a("common.refresh")})})]})]})]})},B=({school:c,subscription:i,onCreateCheckout:d,isCreatingCheckout:n})=>{const{t:r}=b();return i?e.jsx("div",{className:"space-y-6",children:e.jsx(W,{school:c})}):e.jsxs(p,{children:[e.jsxs(N,{children:[e.jsx(f,{children:r("dashboard.weeklySummaries")}),e.jsx(v,{children:r("teacher.subscriptionRequiredForSummaries")})]}),e.jsxs(w,{className:"text-center py-8",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:r("teacher.subscriptionRequiredForSummaries")}),e.jsx(y,{onClick:d,disabled:n,className:"bg-primary hover:bg-primary/90 text-primary-foreground",children:r(n?"pricing.processing":"teacher.subscribeToContinue")})]})]})};export{B as default};
